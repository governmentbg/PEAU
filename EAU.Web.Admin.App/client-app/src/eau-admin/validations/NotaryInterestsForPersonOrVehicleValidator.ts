import { ObjectHelper } from "cnsys-core";
import { EAUBaseValidator } from "eau-core";
import moment, { isMoment } from "moment";
import { NotaryInterestsForPersonOrVehicleSearchCriteria } from "../models/ModelsAutoGenerated";

export class NotaryInterestsForPersonOrVehicleValidator extends EAUBaseValidator<NotaryInterestsForPersonOrVehicleSearchCriteria, any> {

    public validate(obj: NotaryInterestsForPersonOrVehicleSearchCriteria): boolean {

        let isValid = super.validate(obj);

        if (!isValid) {
            return isValid;
        }

        if (ObjectHelper.isStringNullOrEmpty(obj.personIdentifier)
            && ObjectHelper.isStringNullOrEmpty(obj.vehicleRegNumber)
            && ObjectHelper.isStringNullOrEmpty(obj.dateFrom)
            && ObjectHelper.isStringNullOrEmpty(obj.dateTo)) {

            obj.addError(this.getMessage('GL_PERIOD_OF_INTERESTVEHICLE_REG_NUMBER_OR_PERSON_IDENT_MUST_BE_FILLED_E'));
            return false;

        } else if (ObjectHelper.isStringNullOrEmpty(obj.personIdentifier) && ObjectHelper.isStringNullOrEmpty(obj.vehicleRegNumber)) {
            //Попълнете регистрационен номер на МПС или ЕГН/ЛНЧ/ЛН на настоящ собственик/нов собственик/заменител
            obj.addError(this.getMessage('GL_VEHICLE_REG_NUMBER_OR_PERSON_IDENT_MUST_BE_FILLED_E'));
            return false;

        } else if (!isMoment(obj.dateFrom) || !isMoment(obj.dateTo)) {

            obj.addError(this.getMessage('GL_PERIOD_NOTARY_INTEREST_MUST_BE_FILLED_E'));
            return false;

        } else if (isMoment(obj.dateFrom) && isMoment(obj.dateTo)) {
            if (obj.dateFrom > obj.dateTo) {
                //Полето "До" трябва да съдържа дата по-голяма или равна на датата в полето "От".
                obj.addError(this.getMessage('GL_DATE_TO_BEFORE_DATE_FROM_E'));
                return false;
            }

            if (obj.dateTo > moment().endOf('day')) {
                //Полето "До" трябва да съдържа дата по-малка или равна на текущата.
                obj.addError(this.getMessage('GL_DATE_TO_AFTER_CURRENT_E'));
                return false;
            }
        }

        return isValid;
    }
}
